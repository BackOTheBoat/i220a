<!DOCTYPE html>
<html lang="en-US">
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="../../assets/styles/article.css" rel="stylesheet" type="text/css" /> 
    <title>CS 220: Project 2</title>
    <link href="prj2/hl-fine_blue.css" rel="stylesheet"/><link href="https://unpkg.com/purecss@1.0.0/build/pure-min.css" 
       rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async=""></script>    

  </head>
  <body>
    <nav>
      <ul>
	<li><a href="../../index.html" class="material-icons">house</a></li>
	<li><a href="../../docs/index.html">Docs</a></li>
	<li><a href="../../exercises/index.html">Exercises</a></li>
	<li><a href="../../hws/index.html">Homeworks</a></li>
	<li><a href="../../labs/index.html">Labs</a></li>
	<li><a href="../../misc/index.html">Misc</a></li>
	<li><a href="../../projects/index.html">Projects</a></li>
	<li><a href="../../slides/index.html">Slides</a></li>
	<li><a id="loginAction"></a></li>
      </ul>
    </nav>
    <div class="content">
      <section data-coord="prj2.umt:1:0"><h1 data-coord="prj2.umt:1:0">Project 2</h1><p data-coord="prj2.umt:3:0"><strong data-coord="prj2.umt:3:0">Due</strong>: Oct 11, before midnight.
</p><p data-coord="prj2.umt:5:0">This document first provides the aims of this project, followed by a
discussion of its background.  It then lists the requirements as
explicitly as possible.  It then hints at how these requirements can
be met.  Finally, it describes how it can be submitted.
</p><section data-coord="prj2.umt:11:0"><h2 data-coord="prj2.umt:11:0">Aims</h2><p data-coord="prj2.umt:14:0">The aims of this project are as follows:
</p><ul data-coord="prj2.umt:16:0"><li data-coord="prj2.umt:16:0"><p data-coord="prj2.umt:16:4">To give you more exposure to bit twiddling.
</p></li><li data-coord="prj2.umt:18:0"><p data-coord="prj2.umt:18:4">To give you some familiarity with writing code which uses
pointers.
</p></li><li data-coord="prj2.umt:21:0"><p data-coord="prj2.umt:21:4">To force you to write
<em data-coord="prj2.umt:21:84"><a href="https://en.wikipedia.org/wiki/Software_portability" data-coord="prj2.umt:21:84">portable
    code</a></em> which automatically adjusts itself to different size
integers.
</p></li><li data-coord="prj2.umt:26:0"><p data-coord="prj2.umt:26:4">To expose you to
<em data-coord="prj2.umt:26:86"><a href="https://en.wikipedia.org/wiki/Conditional_compilation" data-coord="prj2.umt:26:86">conditional compilation</a></em> using the C preprocessor.
</p></li><li data-coord="prj2.umt:30:0"><p data-coord="prj2.umt:30:4">To introduce you
to <em data-coord="prj2.umt:30:89"><a href="https://en.wikipedia.org/wiki/Test-driven_development" data-coord="prj2.umt:30:89">Test-Driven Development TDD</a></em>.
</p></li></ul></section><section data-coord="prj2.umt:34:0"><h2 data-coord="prj2.umt:34:0">Background</h2><p data-coord="prj2.umt:37:0">The primary requirement for this project is to implement an integer
representation called Binary Coded Decimal.  While solving this
problem you will get exposure to conditional compilation and
test-driven development.  This section provides some background
material for these topics.
</p><section data-coord="prj2.umt:43:0"><h3 data-coord="prj2.umt:43:0">Binary Coded Decimal</h3><p data-coord="prj2.umt:46:0">The unsigned and 2's complement representations covered in class are
only some of the many ways integers can be represented using bits.
Another alternative is
<em data-coord="prj2.umt:46:212"><a href="http://en.wikipedia.org/wiki/Binary-coded_decimal" data-coord="prj2.umt:46:212">binary-coded-decimal BCD</a></em>.
</p><p data-coord="prj2.umt:52:0">BCD representation is straightforward: each decimal digit is
represented using a single <em data-coord="prj2.umt:52:88">nybble</em> (4-bits) with the binary-encoding
of the digit being the straight-forward bit-encoding of that digit.
Successive digits are encoded using successive nybble's.
</p><p data-coord="prj2.umt:57:0">Examples of encodings: (we show the BCD encoding in both hex and
decimal; for interest, we also show a binary encoding).
</p><pre data-coord="prj2.umt:61:0">


-------------------------+------------------+----------------
  Decimal Representation |  BCD Encoding    | Binary Encoding
-------------------------+------------------+----------------
      798                |   0x798 (1944)   |        0x31e
      123                |   0x123 (291)    |         0x7b
    98765                | 0x98765 (624485) |      0x181cd
-------------------------+------------------+----------------
</pre></section><section data-coord="prj2.umt:74:0"><h3 data-coord="prj2.umt:74:0">Conditional Compilation</h3><p data-coord="prj2.umt:77:0">Recall that the C preprocessor is a text-to-text transformer which
runs before compiler proper.  It has no relationship to the compiler
proper other than providing the input to the compiler proper.  The
preprocessor has various features, one of which is
<em data-coord="prj2.umt:77:311"><a href="https://en.wikipedia.org/wiki/Conditional_compilation" data-coord="prj2.umt:77:311">conditional
compilation</a></em>.
</p><p data-coord="prj2.umt:84:0">The preprocessor allows use of <code><span class="hl ppc">#if</span></code> and <code><span class="hl ppc">#endif</span></code> directives to
determine whether code should be included in the compilation.  Here is
a simple example of using these directives to comment out code:
</p><pre><span class="hl ppc">#if 0</span>  <span class="hl slc">//preprocessor directives must be on separate lines</span>
<span class="hl ppc"></span>  <span class="hl kwb">const char</span> <span class="hl opt">*</span>str <span class="hl opt">=</span> <span class="hl str">&quot;some code which is commented out&quot;</span><span class="hl opt">;</span>
<span class="hl ppc">#endif</span></pre><p data-coord="prj2.umt:94:0">Another example is to include a <samp data-coord="prj2.umt:94:32">main()</samp> function used to test
the code within a file <samp data-coord="prj2.umt:94:86">module.c</samp>:
</p><pre><span class="hl ppc">#if TEST</span>
<span class="hl com">/** code for running an interactive test */</span>
<span class="hl kwb">int</span> <span class="hl kwd">main</span><span class="hl opt">() { ... }</span>
<span class="hl ppc">#endif</span></pre><p data-coord="prj2.umt:104:0">In this case, <samp data-coord="prj2.umt:104:14">TEST</samp> is a preprocessor macro.  These are usually
defined within the source code using <code><span class="hl ppc">#define</span></code> directives, but can
also be defined at the compiler command-line using <samp data-coord="prj2.umt:104:184">-DTEST=0</samp> or
<samp data-coord="prj2.umt:104:198">-DTEST=1</samp> command-line options.  For example, a <samp data-coord="prj2.umt:104:247">Makefile</samp> for
<samp data-coord="prj2.umt:104:262">module.c</samp> may include targets like the following:
</p><pre>OBJ_FILES <span class="hl opt">=</span> ... module.o ...

<span class="hl slc">#link to produce main executable without test code</span>
my-executable<span class="hl opt">:   $(</span>OBJ_FILES<span class="hl opt">)</span>
                 <span class="hl opt">$(</span>CC<span class="hl opt">) $</span>? <span class="hl opt">$(</span>LDFLAGS<span class="hl opt">) -</span>o <span class="hl opt">$</span>&#64;

<span class="hl slc">#module.o built using a normal implicit compilation command like</span>
<span class="hl slc">#</span>
<span class="hl slc">#$(CC) $(CFLAGS) -c module.c;</span>
<span class="hl slc">#</span>
<span class="hl slc">#since TEST is not defined, it defaults to 0</span>
<span class="hl slc">#and no test code is compiled in.</span>
module.o<span class="hl opt">:</span>       module.c module.h

<span class="hl slc">#this builds a module-test executable.</span>
<span class="hl slc">#since TEST defined as 1, test code is compiled in.</span>
module-test<span class="hl opt">:</span>    module.c module.h
                <span class="hl opt">$(</span>CC<span class="hl opt">) $(</span>CFLAGS<span class="hl opt">) -</span>DTEST<span class="hl opt">=</span><span class="hl num">1</span> <span class="hl opt">$&lt; $(</span>LDFLAGS<span class="hl opt">) -</span>o <span class="hl opt">$</span>&#64;</pre><p data-coord="prj2.umt:132:0">With the above <samp data-coord="prj2.umt:132:15">Makefile</samp>, when <samp data-coord="prj2.umt:132:32">module.o</samp> is linked into <samp data-coord="prj2.umt:132:58">my-executable</samp>,
<samp data-coord="prj2.umt:132:75">TEST</samp> is not defined and hence the testing <samp data-coord="prj2.umt:132:119">main()</samp> is not included
within <samp data-coord="prj2.umt:132:151">my-executable</samp>.  However, if <samp data-coord="prj2.umt:132:181">module-test</samp> is built using a
command like <samp data-coord="prj2.umt:132:225">make module-test</samp>, then the compiler command-line option
<samp data-coord="prj2.umt:132:283">-DTEST=1</samp> sets <samp data-coord="prj2.umt:132:299">TEST</samp> to 1 and the testing <samp data-coord="prj2.umt:132:327">main()</samp> will be included
within the compilation.
</p><p data-coord="prj2.umt:139:0">This project uses conditional compilation to define different
C integer types for <samp data-coord="prj2.umt:139:82">Bcd</samp>:
</p><pre><span class="hl com">/** Representation used for a BCD number: define based on BCD_BASE */</span>
<span class="hl ppc">#ifndef BCD_BASE</span>
  <span class="hl ppc">#define BCD_BASE 2</span>
<span class="hl ppc">#endif</span>

<span class="hl slc">//Depending on BCD_BASE, conditionally define:</span>
<span class="hl slc">//  Bcd:                 C type used to represent a BCD</span>
<span class="hl slc">//  BCD_FORMAT_MODIFIER: modifier used to printf() a BCD</span>
<span class="hl slc">//  SCANF_MODIFIER:      modifier used to scanf() a BCD</span>
<span class="hl ppc">#if BCD_BASE == 0</span>
  <span class="hl kwc">typedef</span> <span class="hl kwb">unsigned char</span> Bcd<span class="hl opt">;</span>
  <span class="hl ppc">#define BCD_FORMAT_MODIFIER</span> <span class="hl pps">&quot;&quot;</span><span class="hl ppc"></span>
  <span class="hl ppc">#define SCANF_MODIFIER</span> <span class="hl pps">&quot;hh&quot;</span><span class="hl ppc"></span>
<span class="hl ppc">#elif BCD_BASE == 1</span>
  <span class="hl kwc">typedef</span> <span class="hl kwb">unsigned short</span> Bcd<span class="hl opt">;</span>
  <span class="hl ppc">#define BCD_FORMAT_MODIFIER</span> <span class="hl pps">&quot;&quot;</span><span class="hl ppc"></span>
  <span class="hl ppc">#define SCANF_MODIFIER</span> <span class="hl pps">&quot;h&quot;</span><span class="hl ppc"></span>
<span class="hl ppc">#elif BCD_BASE == 2</span>
  <span class="hl kwc">typedef</span> <span class="hl kwb">unsigned</span> Bcd<span class="hl opt">;</span>
  <span class="hl ppc">#define BCD_FORMAT_MODIFIER</span> <span class="hl pps">&quot;&quot;</span><span class="hl ppc"></span>
  <span class="hl ppc">#define SCANF_MODIFIER BCD_FORMAT_MODIFIER</span>
<span class="hl ppc">#elif BCD_BASE == 3</span>
  <span class="hl kwc">typedef</span> <span class="hl kwb">unsigned long</span> Bcd<span class="hl opt">;</span>
  <span class="hl ppc">#define BCD_FORMAT_MODIFIER</span> <span class="hl pps">&quot;l&quot;</span><span class="hl ppc"></span>
  <span class="hl ppc">#define SCANF_MODIFIER BCD_FORMAT_MODIFIER</span>
<span class="hl ppc">#elif BCD_BASE == 4</span>
  <span class="hl kwc">typedef</span> <span class="hl kwb">unsigned long long</span> Bcd<span class="hl opt">;</span>
  <span class="hl ppc">#define BCD_FORMAT_MODIFIER</span> <span class="hl pps">&quot;ll&quot;</span><span class="hl ppc"></span>
  <span class="hl ppc">#define SCANF_MODIFIER BCD_FORMAT_MODIFIER</span>
<span class="hl ppc">#else</span>
  <span class="hl ppc">#error</span> <span class="hl pps">&quot;invalid BCD_BASE value&quot;</span><span class="hl ppc"></span>
  <span class="hl slc">//avoid subsequent compiler errors by providing definitions</span>
  <span class="hl kwc">typedef</span> <span class="hl kwb">unsigned long long</span> Bcd<span class="hl opt">;</span>
  <span class="hl ppc">#define BCD_FORMAT_MODIFIER</span> <span class="hl pps">&quot;ll&quot;</span><span class="hl ppc"></span>
  <span class="hl ppc">#define SCANF_MODIFIER BCD_FORMAT_MODIFIER</span>
<span class="hl ppc">#endif</span></pre><p data-coord="prj2.umt:181:0">The above code <code><span class="hl kwc">typedef</span></code>'s <samp data-coord="prj2.umt:181:28">Bcd</samp> to different C integer types
as well as defining the appropriate modifiers which can be used
for printing or reading a <samp data-coord="prj2.umt:181:153">Bcd</samp>.  The <samp data-coord="prj2.umt:181:165">Bcd</samp> type chosen depends on
the value of <samp data-coord="prj2.umt:181:207">BCD_BASE</samp> which can be specified on the compiler
command-line using <samp data-coord="prj2.umt:181:276">-DBCD_BASE=...</samp>; if <samp data-coord="prj2.umt:181:297">BCD_BASE</samp> is not provided
on the compiler command-line, then the initial <code><span class="hl ppc">#ifdef</span></code> section
will default it to 2 (with <samp data-coord="prj2.umt:181:416">Bcd</samp> becoming an <code><span class="hl kwb">unsigned</span></code>).
</p></section><section data-coord="prj2.umt:190:0"><h3 data-coord="prj2.umt:190:0">Test-Driven Development</h3><p data-coord="prj2.umt:193:0"><strong data-coord="prj2.umt:193:0">Automated</strong> testing is an integral part of modern software development
practices.  In <strong data-coord="prj2.umt:193:86">test-driven development</strong>, tests are written before the
code which is to be tested.  In this project, you are being provided
with a set of tests and you will write code to make the tests pass;
i.e. your development will be driven by the tests.
</p><p data-coord="prj2.umt:199:0">There are multiple testing frameworks available for different
programming languages.  This project uses the
<a href="http://check.sourceforge.net/doc/check_html/" data-coord="prj2.umt:199:156">check</a> testing
framework for C.
</p></section></section><section data-coord="prj2.umt:204:0"><h2 data-coord="prj2.umt:204:0">Requirements</h2><p data-coord="prj2.umt:207:0">Update the <samp data-coord="prj2.umt:207:11">master</samp> branch of your github repository with a directory
<samp data-coord="prj2.umt:207:70">submit/prj2-sol</samp> such that that typing <samp data-coord="prj2.umt:207:110">make</samp> within that directory
will build executables <samp data-coord="prj2.umt:207:162">bcd-0</samp>, <samp data-coord="prj2.umt:207:171">bcd-1</samp>, <samp data-coord="prj2.umt:207:180">bcd-2</samp>, <samp data-coord="prj2.umt:207:189">bcd-3</samp> and <samp data-coord="prj2.umt:207:201">bcd-4</samp>
which correspond respectively to using <code><span class="hl kwb">unsigned char</span></code>, <code><span class="hl kwb">unsigned</span>
<span class="hl kwb">short</span></code>, <code><span class="hl kwb">unsigned int</span></code>, <code><span class="hl kwb">unsigned long</span></code> and <code><span class="hl kwb">unsigned long long</span></code> to
represent a BCD.  Additionally, <samp data-coord="prj2.umt:207:380">bcd</samp> should be sym-linked as <samp data-coord="prj2.umt:207:410">bcd-2</samp>.
</p><p data-coord="prj2.umt:214:0">When any of the above programs is invoked, it must read lines from
standard input.
</p><ul data-coord="prj2.umt:217:0"><li data-coord="prj2.umt:217:0"><p data-coord="prj2.umt:217:4">If the line contains a single non-negative decimal integer, then
the program must print a line containing the string representation
of the BCD representation of that integer, followed by the decimal
value of that BCD representation in parentheses.
</p></li><li data-coord="prj2.umt:222:0"><p data-coord="prj2.umt:222:4">If the line contains 2 non-negative decimal integers separated by
a <samp data-coord="prj2.umt:222:76">+</samp> character and the sum of the two integers is <samp data-coord="prj2.umt:222:125">sum</samp>, then the
program must print a line containing the string representation of
the BCD representation of <samp data-coord="prj2.umt:222:241">sum</samp>, followed by the decimal value of
that BCD representation in parentheses.
</p></li><li data-coord="prj2.umt:228:0"><p data-coord="prj2.umt:228:4">If the line contains 2 non-negative decimal integers separated by
a <samp data-coord="prj2.umt:228:76">*</samp> character and the product of the two integers is <samp data-coord="prj2.umt:228:129">prod</samp>,
then the program must print a line containing the string
representation of the BCD representation of <samp data-coord="prj2.umt:228:246">prod</samp>, followed by the decimal
value of that BCD representation in parentheses.
</p></li><li data-coord="prj2.umt:234:0"><p data-coord="prj2.umt:234:4">If the contents of the line does not match any of the above, then
the program should signal an appropriate error and continue
processing its standard input.
</p></li></ul><p data-coord="prj2.umt:238:0">Errors which must be signalled include:
</p><ul data-coord="prj2.umt:240:0"><li data-coord="prj2.umt:240:0"><p data-coord="prj2.umt:240:4"><strong data-coord="prj2.umt:240:4">Bad BCD Digit</strong>:  A nybble within a BCD is greater than 9.
</p></li><li data-coord="prj2.umt:242:0"><p data-coord="prj2.umt:242:4"><strong data-coord="prj2.umt:242:4">Overflow</strong>: A value is too large to be represented within
a BCD type.
</p></li></ul><p data-coord="prj2.umt:245:0">The above program <strong data-coord="prj2.umt:245:18">must</strong> be implemented using a <samp data-coord="prj2.umt:245:48">bcd</samp> module which
meets the specifications provided in <a href="prj2-sol/bcd.h" data-coord="prj2.umt:245:122">bcd.h.</a>
</p><p data-coord="prj2.umt:248:0">You may assume that the character encoding for the digit-characters is
such that the value of the digit represented by digit-character <samp data-coord="prj2.umt:248:135">c</samp> is
<samp data-coord="prj2.umt:248:142">c - '0'</samp>.
</p><p data-coord="prj2.umt:252:0">The operation of the program is illustrated in 
<a href="extras/run.LOG" data-coord="prj2.umt:252:66">run.LOG.</a>  Testing behavior is illustrated
in <a href="extras/check.LOG" data-coord="prj2.umt:252:131">check.LOG.</a>
</p></section><section data-coord="prj2.umt:256:0"><h2 data-coord="prj2.umt:256:0">Provided Files</h2><p data-coord="prj2.umt:259:0">The <a href="./prj2-sol" data-coord="prj2.umt:259:18">prj2-sol</a> directory contains the following files:
</p><dl data-coord="prj2.umt:261:0"><dt data-coord="prj2.umt:261:2"> <a href="./prj2-sol/bcd.c" data-coord="prj2.umt:261:21">bcd.c</a></dt><dd data-coord="prj2.umt:262:0"><p data-coord="prj2.umt:262:4">The main file which you will be modifying.  It contains <samp data-coord="prj2.umt:262:60">@TODO</samp>
comments which you should replace with your code.
</p></dd><dt data-coord="prj2.umt:265:2"> <a href="./prj2-sol/bcd.h" data-coord="prj2.umt:265:21">bcd.h</a></dt><dd data-coord="prj2.umt:266:0"><p data-coord="prj2.umt:266:4">The specification for the BCD functions you will be implementing.
You should not modify this file.
</p></dd><dt data-coord="prj2.umt:269:2"> <a href="./prj2-sol/bcd-test.c" data-coord="prj2.umt:269:26">bcd-test.c</a></dt><dd data-coord="prj2.umt:270:0"><p data-coord="prj2.umt:270:4">A file which contains test code.
</p></dd><dt data-coord="prj2.umt:272:2"> <a href="./prj2-sol/check-extra.h" data-coord="prj2.umt:272:29">check-extra.h</a></dt><dd data-coord="prj2.umt:273:0"><p data-coord="prj2.umt:273:4">Supplements <samp data-coord="prj2.umt:273:16">check</samp> with testing macros for <code><span class="hl kwb">unsigned long</span></code> and
<code><span class="hl kwb">unsigned long long</span></code>.
</p></dd><dt data-coord="prj2.umt:276:2"> <a href="./prj2-sol/main.c" data-coord="prj2.umt:276:22">main.c</a></dt><dd data-coord="prj2.umt:277:0"><p data-coord="prj2.umt:277:4">The command-line interface.  You should not need to modify this
file.
</p></dd><dt data-coord="prj2.umt:280:2"> <a href="./prj2-sol/Makefile" data-coord="prj2.umt:280:24">Makefile</a></dt><dd data-coord="prj2.umt:281:0"><p data-coord="prj2.umt:281:4">A non-trivial Makefile.  Simply typing <samp data-coord="prj2.umt:281:43">make</samp> runs the default
targets which builds <samp data-coord="prj2.umt:281:92">bcd</samp> as well as <samp data-coord="prj2.umt:281:109">bcd-0</samp>, \(\ldots\), <samp data-coord="prj2.umt:281:129">bcd-4</samp>.
</p><p data-coord="prj2.umt:284:4">Running <samp data-coord="prj2.umt:284:12">make check</samp> runs all tests for all of <samp data-coord="prj2.umt:284:51">bcd-0</samp>, \(\ldots\),
<samp data-coord="prj2.umt:284:75">bcd-4</samp>.  You can selectively run tests for different functions
by typing <samp data-coord="prj2.umt:284:153">make check TEST=</samp><em data-coord="prj2.umt:284:175">test</em> for <em data-coord="prj2.umt:284:186">test</em> in
<samp data-coord="prj2.umt:284:200">binary_to_bcd_test</samp>, <samp data-coord="prj2.umt:284:222">bcd_to_binary_test</samp>, <samp data-coord="prj2.umt:284:244">str_to_bcd_test</samp>,
<samp data-coord="prj2.umt:284:267">bcd_to_str_test</samp>, <samp data-coord="prj2.umt:284:286">bcd_add_test</samp>, <samp data-coord="prj2.umt:284:302">bcd_multiply_test</samp> and
<samp data-coord="prj2.umt:284:330">bcd_multiop_test</samp> all of which run tests only for the corresponding
BCD function except <samp data-coord="prj2.umt:284:423">bcd_multiop_test</samp> which runs multiple BCD
functions.
</p><p data-coord="prj2.umt:293:4">If a test is failing, you can look at the code in
<a href="./prj2-sol/bcd-test.c" data-coord="prj2.umt:293:83">bcd-test.c</a> to understand why it may be
failing.  However, you can also add <samp data-coord="prj2.umt:293:162">BCD_TEST_TRACE=1</samp> to
the <samp data-coord="prj2.umt:293:192">make check</samp> command which shows the actual and expected
output for each test which is run.
</p></dd><dt data-coord="prj2.umt:299:2"> <a href="./prj2-sol/README" data-coord="prj2.umt:299:22">README</a></dt><dd data-coord="prj2.umt:300:0"><p data-coord="prj2.umt:300:4">A README file which must be submitted along with your project.  It
contains an initial header which you must complete (replace the
dummy entries with your name, B-number and email address at which
you would like to receive project-related email).  After the
header you may include any content which you would like read
during the grading of your project.  If your project is
not complete, document what is not working in the <samp data-coord="prj2.umt:300:453">README</samp>.
</p></dd><dt data-coord="prj2.umt:308:2"> <a href="./prj2-sol/.gitignore" data-coord="prj2.umt:308:27">.gitignore</a> </dt><dd data-coord="prj2.umt:309:0"><p data-coord="prj2.umt:309:4">A file which lists paths which should be ignored by git.
You should not need to modify this file.
</p></dd></dl><p data-coord="prj2.umt:312:0">The <a href="extras" data-coord="prj2.umt:312:14">extras</a> directory contains the following files:
</p><dl data-coord="prj2.umt:314:0"><dt data-coord="prj2.umt:314:2"> <a href="extras/run.LOG" data-coord="prj2.umt:314:19">run.LOG</a></dt><dd data-coord="prj2.umt:315:0"><p data-coord="prj2.umt:315:4">A log of the command-line behavior.
</p></dd><dt data-coord="prj2.umt:317:2"> <a href="extras/check.LOG" data-coord="prj2.umt:317:21">check.LOG</a></dt><dd data-coord="prj2.umt:318:0"><p data-coord="prj2.umt:318:4">A log of running tests.
</p></dd><dt data-coord="prj2.umt:320:2"> <samp data-coord="prj2.umt:320:1">bcd</samp>, <samp data-coord="prj2.umt:320:8">bcd-0</samp>, \(\ldots\), <samp data-coord="prj2.umt:320:28">bcd-4</samp> </dt><dd data-coord="prj2.umt:321:0"><p data-coord="prj2.umt:321:4">Executables which you can use to validate your understanding
of the project requirements.
</p></dd></dl></section><section data-coord="prj2.umt:324:0"><h2 data-coord="prj2.umt:324:0">Hints</h2><p data-coord="prj2.umt:327:0">Since you are required to have your code work with different
underlying C types mapped to the <samp data-coord="prj2.umt:327:94">Bcd</samp> type, it is imperative that
your code not make any assumptions on the size of the <samp data-coord="prj2.umt:327:182">Bcd</samp> type.
Instead your code should use the constants <samp data-coord="prj2.umt:327:237">BCD_BITS</samp>,
<samp data-coord="prj2.umt:327:249">MAX_BCD_DIGITS</samp> and <samp data-coord="prj2.umt:327:270">BCD_BUF_SIZE</samp> defined in <a href="./prj2-sol/bcd.h" data-coord="prj2.umt:327:316">bcd.h.</a>
</p><p data-coord="prj2.umt:334:0">The following points are not prescriptive in that you may choose to ignore
them as long as you meet all the project requirements.
</p><ol data-coord="prj2.umt:337:0"><li data-coord="prj2.umt:337:0"><p data-coord="prj2.umt:337:4">Make sure you understand BCD representation.  It may also be a
good idea to review elementary school methods for addition and
long multiplication.
</p></li><li data-coord="prj2.umt:341:0"><p data-coord="prj2.umt:341:4">Start your project in a manner similar to how you start a lab.
</p><ol data-coord="prj2.umt:343:0"><li data-coord="prj2.umt:343:0"><p data-coord="prj2.umt:343:8">Ensure that your local copy of the <samp data-coord="prj2.umt:343:43">cs220</samp> course repository is
up-to-date:
</p><pre>        $ <span class="hl kwb">cd</span> ~<span class="hl opt">/</span>cs220
        $ git pull</pre></li><li data-coord="prj2.umt:352:0"><p data-coord="prj2.umt:352:8">Create a branch for this project in your working copy
of your github respository:
</p><pre>        $ <span class="hl kwb">cd</span> ~<span class="hl opt">/</span>i220?           <span class="hl slc">#go to clone of github repo</span>
        $ git checkout master  <span class="hl slc">#ensure in master branch</span>
        $ git pull             <span class="hl slc">#ensure master up-to-date</span>
        $ git checkout <span class="hl kwb">-b</span> prj2 <span class="hl slc">#make new branch</span></pre></li><li data-coord="prj2.umt:363:0"><p data-coord="prj2.umt:363:8">Copy over the provided files and commit them to github:
</p><pre>        $ <span class="hl kwb">cd</span> ~<span class="hl opt">/</span>i220?<span class="hl opt">/</span>submit
        $ <span class="hl kwc">cp</span> <span class="hl kwb">-pr</span> ~<span class="hl opt">/</span>cs220<span class="hl opt">/</span>projects<span class="hl opt">/</span>prj<span class="hl num">2</span><span class="hl opt">/</span>prj2-sol .
        $ <span class="hl kwb">cd</span> prj2-sol
        $ git add .
        $ git commit <span class="hl kwb">-m</span> <span class="hl str">&apos;started prj2&apos;</span>
        $ git push <span class="hl kwb">-u</span> origin prj2 <span class="hl slc">#push prj2 branch to github</span></pre></li></ol></li><li data-coord="prj2.umt:375:0"><p data-coord="prj2.umt:375:4">Fill in your details in the <samp data-coord="prj2.umt:375:32">README</samp> template.  Commit and push
your changes.
</p></li><li data-coord="prj2.umt:378:0"><p data-coord="prj2.umt:378:4">Verify that you can build the executables using the provided
<samp data-coord="prj2.umt:378:69">Makefile</samp> by simply typing <samp data-coord="prj2.umt:378:97">make</samp>.
</p></li><li data-coord="prj2.umt:381:0"><p data-coord="prj2.umt:381:4">Verify that you can run tests by typing <samp data-coord="prj2.umt:381:44">make check</samp>.  At this
stage, most of the tests will fail (some pass purely coincidentally).
</p></li><li data-coord="prj2.umt:384:0"><p data-coord="prj2.umt:384:4">Open up your copy of <samp data-coord="prj2.umt:384:25">bcd.c</samp> in a text editor. It may be a good
idea to define utility routines like <samp data-coord="prj2.umt:384:109">get_bcd_digit()</samp> and
<samp data-coord="prj2.umt:384:135">set_bcd_digit()</samp> with suitable parameters.
</p></li><li data-coord="prj2.umt:388:0"><p data-coord="prj2.umt:388:4">Define the <samp data-coord="prj2.umt:388:15">binary_to_bcd()</samp> routine.  Notice that you can iterate
through the digits of a binary <samp data-coord="prj2.umt:388:106">value</samp> by using <samp data-coord="prj2.umt:388:123">value%10</samp> to
extract the digit and <samp data-coord="prj2.umt:388:163">value /= 10</samp> to "shift" the value over by
one digit.  Once you have the digit, it needs to be inserted into
the correct position into a <samp data-coord="prj2.umt:388:309">Bcd</samp> accumulator.
</p><p data-coord="prj2.umt:394:4">Verify your <samp data-coord="prj2.umt:394:16">binary_to_bcd()</samp> code by running:
</p><pre>    $ make check TEST<span class="hl opt">=</span>binary_to_bcd_test</pre><p data-coord="prj2.umt:400:4">If you would like information about the tests being run, use:
</p><pre>    $ make check TEST<span class="hl opt">=</span>binary_to_bcd_test BCD_TEST_TRACE<span class="hl opt">=</span><span class="hl num">1</span> </pre></li><li data-coord="prj2.umt:407:0"><p data-coord="prj2.umt:407:4">Define the <samp data-coord="prj2.umt:407:15">bcd_to_binary()</samp> routine.  You can use your
<samp data-coord="prj2.umt:407:64">get_bcd_digit()</samp> function to extract a BCD digit.  Once you have
it, ensure that it is less than 10, otherwise signal a
<samp data-coord="prj2.umt:407:193">BAD_VALUE_ERR</samp> error.  Accumulate it into a binary number,
"shifting" it for each digit.
</p><p data-coord="prj2.umt:413:4">Test using <samp data-coord="prj2.umt:413:15">make check TEST=bcd_to_binary_test</samp>.
</p></li><li data-coord="prj2.umt:416:0"><p data-coord="prj2.umt:416:4">Define the <samp data-coord="prj2.umt:416:15">str_to_bcd()</samp> routine.  For each digit-character <samp data-coord="prj2.umt:416:65">d</samp>,
get its value using <samp data-coord="prj2.umt:416:94">d - '0'</samp> and accumulate the value in a <samp data-coord="prj2.umt:416:134">Bcd</samp>.
If the number of digits turns out to be greater than
<samp data-coord="prj2.umt:416:202">MAX_BCD_DIGITS</samp> return an overflow error.  Make sure that the
pointer argument to the routine is updated to point to the first
non-digit-character.
</p><p data-coord="prj2.umt:423:4">Test using <samp data-coord="prj2.umt:423:15">make check TEST=str_to_bcd_test</samp>.
</p></li><li data-coord="prj2.umt:425:0"><p data-coord="prj2.umt:425:4">Define the <samp data-coord="prj2.umt:425:15">bcd_to_str()</samp> routine.  You should first check whether
the provided buffer size is at least <samp data-coord="prj2.umt:425:112">BCD_BUF_SIZE</samp>, otherwise
report an <samp data-coord="prj2.umt:425:152">OVERFLOW_ERR</samp> error.  After ensuring that all the BCD
digits are valid (less than 10), the guts of the functionality can
be achieved by simply using
<a href="https://www.man7.org/linux/man-pages/man3/snprintf.3.html" data-coord="prj2.umt:425:379">snprintf()</a> with the <samp data-coord="prj2.umt:425:399">%x</samp> format-specifier.
</p><p data-coord="prj2.umt:433:4">Test using <samp data-coord="prj2.umt:433:15">make check TEST=bcd_to_str_test</samp>.
</p></li><li data-coord="prj2.umt:435:0"><p data-coord="prj2.umt:435:4">Write the <samp data-coord="prj2.umt:435:14">bcd_add()</samp> routine.  Use the addition algorithm you
learnt in elementary school: add digit by digit, propagating a
carry if necessary.  If the binary sum of 2 BCD digits and current
carry is <samp data-coord="prj2.umt:435:218">sum</samp>, you can get the resulting BCD digit as <samp data-coord="prj2.umt:435:264">sum % 10</samp>
and the propagated carry as <samp data-coord="prj2.umt:435:307">sum / 10</samp>.  You will have an overflow
if the carry is non-zero from the most significant BCD addition.
</p><p data-coord="prj2.umt:442:4">Test using <samp data-coord="prj2.umt:442:15">make check TEST=bcd_add_test</samp>.
</p></li><li data-coord="prj2.umt:444:0"><p data-coord="prj2.umt:444:4">In preparation for the multiplication, it may be a good idea
to write a routine which multiplies a BCD representation by
 a single BCD digit (in [0, 9]):
</p><pre>    <span class="hl com">/** Return Bcd representation of result of multiplying Bcd</span>
<span class="hl com">     *  value multiplicand by BCD digit bcdDigit (in [0, 9]).</span>
<span class="hl com">     *</span>
<span class="hl com">     *  If error is not NULL, sets *error to BAD_VALUE_ERR if</span>
<span class="hl com">     *  multiplicand contains a BCD digit which is greater than 9,</span>
<span class="hl com">     *  OVERFLOW_ERR on overflow, otherwise *error is unchanged.</span>
<span class="hl com">     */</span>
     <span class="hl kwb">static</span> Bcd
     <span class="hl kwd">bcd_multiply_digit</span><span class="hl opt">(</span>Bcd multiplicand<span class="hl opt">,</span> <span class="hl kwb">unsigned</span> bcdDigit<span class="hl opt">,</span>
                        BcdError <span class="hl opt">*</span>error<span class="hl opt">);</span></pre></li><li data-coord="prj2.umt:461:0"><p data-coord="prj2.umt:461:4">Implement <samp data-coord="prj2.umt:461:14">bcd_multiply()</samp>.  Use the long-multiplication algorithm
you learnt in elementary school.  Initialize an accumulating
result to 0.  For each digit in the multiplier, multiply the
multiplicand by it (using <samp data-coord="prj2.umt:461:231">bcd_multiply_digit()</samp>) and then add the
result (suitably shifted, using <samp data-coord="prj2.umt:461:308">bcd_add()</samp>) to the accumulating
result.
</p><p data-coord="prj2.umt:468:4">Test using <samp data-coord="prj2.umt:468:15">make check TEST=bcd_multiply_test</samp>.
</p></li><li data-coord="prj2.umt:470:0"><p data-coord="prj2.umt:470:4">Iterate the previous steps until you meet all the project requirements
and all tests pass.
</p></li></ol></section><section data-coord="prj2.umt:473:0"><h2 data-coord="prj2.umt:473:0">Submission</h2><p data-coord="prj2.umt:476:0">Submit using a procedure similar to that used in your labs:
</p><pre>    $ <span class="hl kwb">cd</span> ~<span class="hl opt">/</span>i220X
    $ git branch <span class="hl kwb">-l</span>       <span class="hl slc">#list all branches;</span>
                          <span class="hl slc"># current branch has *, should be prj2.</span>
    $ git checkout master <span class="hl slc">#goto master branch</span>
    $ git pull            <span class="hl slc"># pull changes (if any)</span>
    $ git checkout prj2   <span class="hl slc">#back to prj2 branch</span>
    $ git merge <span class="hl kwb">-m</span> <span class="hl str">&apos;merged master&apos;</span> master  <span class="hl slc"># may not do anything</span>
    $ git status <span class="hl kwb">-s</span>       <span class="hl slc">#should show any non-committed changes</span>
    $ git commit <span class="hl kwb">-a -m</span> <span class="hl str">&apos;completing prj2&apos;</span>
    $ git push            <span class="hl slc">#push prj2 branch to github</span>
    $ git checkout master <span class="hl slc">#switch to master branch</span>
    $ git merge prj2 <span class="hl kwb">-m</span> <span class="hl str">&apos;merged prj2&apos;</span> <span class="hl slc">#merge in prj2 branch</span>
    $ git push            <span class="hl slc">#submit project</span></pre></section></section>
    </div> <!-- #content -->
    <script src="../../assets/scripts/loginAction.js"></script>
  </body>
</html>
